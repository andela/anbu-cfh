<div class="mdl-layout mdl-js-layout mdl-layout--fixed-header" ng-controller="GameController">
  <div class="cfh-header mdl-layout__header mdl-layout__header--waterfall" style="background-color:#46B6AC;color: #000">
    <style>
      .cfh-header .mdl-navigation__link {
        color: #000;
      }
    </style>
    <div class="mdl-layout__header-row">
      <span class="cfh-title mdl-layout-title text-logo">
        <a href="/" style="text-decoration: none; color: #fff">Cards For Humanity</a>
      </span>
      <!-- Add spacer, to align navigation to the right in desktop-->
      <div class="cfh-header-spacer mdl-layout-spacer"></div>
      <!-- Navigation-->
      <div class="cfh-navigation-container">
        <nav class="cfh-navigation mdl-navigation">
          <a id="home" href="/#!/#top" class="mdl-navigation__link mdl-typography--text-uppercase">
            <i class="material-icons">home</i>
            <div class="mdl-tooltip" data-mdl-for="home">
              <strong>Home</strong>
            </div>
          </a>
          <a ng-show="userName" href id="notifications" class="mdl-navigation__link mdl-typography--text-uppercase" ng-click="openNotifications()">
            <span ng-show="friends.gameInvites.length > 0" class="material-icons mdl-badge mdl-badge--overlap" data-badge="{{friends.gameInvites.length}}">
              notifications
            </span> 
            <i ng-hide="friends.gameInvites.length > 0" class="material-icons">notifications</i>
            <div class="mdl-tooltip" data-mdl-for="notifications">
              <strong>Notifications</strong>
            </div>
          </a>
          <a href ng-show="userName" id="requests" class="mdl-navigation__link mdl-typography--text-uppercase"
          ng-click="openFriends()">
            <i class="material-icons">people</i>
            <div class="mdl-tooltip" data-mdl-for="requests">
              <strong>Send Invites</strong>
            </div>
          </a>
          <a id="invite-players-button-desktop" class="mdl-navigation__link mdl-typography--text-uppercase">
            <i class="material-icons">&#xE24F;</i>
            <span class="mdl-tooltip" data-mdl-for="invite-players-button-desktop">
              Invite <strong>Players</strong>
            </span>
          </a>
          <a id='game-history-button-desktop' ng-click="gameLog()" class="mdl-navigation__link mdl-typography--text-uppercase">
            <i class="material-icons">&#xE889;</i>
            <span class="mdl-tooltip" data-mdl-for="game-history-button-desktop">
              Game <strong>History</strong>
            </span>
          </a>
          <a href="#" id='abandon-game-button' ng-click="abandonGame()" class="mdl-navigation__link mdl-typography--text-uppercase">
            <i class="material-icons" style="background-color:#fff;border-radius:100%">&#xE5C9;</i>
            <div class="mdl-tooltip" data-mdl-for="abandon-game-button">
              Abandon <strong>Game</strong>
            </div>
          </a>
          <a ng-show="userName" id="signout" href="/signout" class="mdl-navigation__link mdl-typography--text-uppercase">
            <i class="material-icons" style="background-color:#fff;" >&#xE879;</i>
            <div class="mdl-tooltip" data-mdl-for="signout">
              <strong>Signout</strong>
            </div>
          </a>
        </nav>
      </div>
      <div class="android-mobile-title mdl-layout-title text-logo-mobile">
        <a href="/" style="text-decoration: none; color: #FFF;font-family: Montserrat; float:left; margin-left:15px; display: inline-block">CFH</a>

        <a ng-show="userName" href id="notifications" ng-click="openNotifications()" style="display: inline-block;float: right">
          <span ng-show="friends.gameInvites.length > 0" class="material-icons mdl-badge mdl-badge--overlap" data-badge="{{friends.gameInvites.length}}">
            notifications
          </span> 
          <i ng-hide="friends.gameInvites.length > 0" class="material-icons">notifications</i>
          <div class="mdl-tooltip" data-mdl-for="notifications">
            <strong>Notifications</strong>
          </div>
        </a>

        <a href ng-show="userName" id="requests" ng-click="openFriends()" style="display: inline-block;float: right">
          <i class="material-icons">people</i>
          <div class="mdl-tooltip" data-mdl-for="requests">
            <strong>Send Invites</strong>
          </div>
        </a>
         <a id="invite-players-button-mobile" class=" invitePlayersButton">
           <i class="material-icons" style="display: inline-block;float: right">&#xE24F;</i>
            <span class="mdl-tooltip" data-mdl-for="invite-players-button-mobile">
              Invite <strong>Players</strong>
            </span>
        </a>
       <a id='game-history-button-mobile' ng-click="gameLog()" class="gameHistoryButton">
          Game History
          <i class="material-icons" style="display: inline-block;float: right">&#xE889;</i>
          <span class="mdl-tooltip" data-mdl-for="game-history-button-mobile">
            Game <strong>History</strong>
          </span>
        </a>
        <a href="#" id ='abandon-button' ng-click="abandonGame()" style="display: inline-block;float: right">
          <i class="material-icons" style="background-color:#fff;border-radius:100%">&#xE5C9;</i>
          <span class="mdl-tooltip" data-mdl-for="abandon-button">
            Abandon <strong>Game</strong>
          </span>
        </a>

        <a ng-show="userName" id="signout" href="/signout" style="display: inline-block;float: right">
          <i class="material-icons" style="background-color:#fff;">&#xE879;</i>
          <span class="mdl-tooltip" data-mdl-for="signout">
            <strong>Signout</strong>
          </span>
        </a>
        
      </div>
    </div>
  </div>
  <div class="cfh-drawer mdl-layout__drawer">
    <nav class="mdl-navigation">
      <a href="/#!/#top" class="mdl-navigation__link">HOME</a>
      <a href="#" id='abandon-game-button' ng-click="abandonGame()" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent">Abandon Game</a>
      <a ng-show="userName" href="/signout" class="mdl-navigation__link mdl-typography--text-uppercase">SIGN OUT</a>
      
      <a href ng-click="openNotifications()" class="mdl-navigation__link" ng-show="userName">NOTIFICATIONS
        <span ng-show="friends.gameInvites.length > 0" class="mdl-badge" data-badge="{{friends.gameInvites.length}}"></span>
      </a>
      <a href class="mdl-navigation__link" ng-show="userName" id="requests"
      ng-click="openFriends()">
      SEND INVITES
      </a>
    </nav>
  </div>
  <div class="cfh-content mdl-layout__content" style="margin-top: 60px">
    <div id="app-container" style="margin: 0 auto">
      <div class="game mdl-grid">
        <div class="mdl-cell mdl-cell--9-col mdl-cell--12-col-tablet mdl-cell--12-col-phone">
          <div class="mdl-grid">
            <div class="mdl-cell mdl-cell--3-col mdl-cell--12-col-tablet time-remaining mdl-card mdl-shadow--4dp">
              <timer></timer>
            </div>

            <div class="mdl-cell mdl-cell--9-col mdl-cell--12-col-tablet question-box mdl-card mdl-shadow--4dp">
              <question></question>
            </div>

            <div class="mdl-cell mdl-cell--12-col answer-box">
              <div class="mdl-card mdl-shadow--4dp game-cards card-for-game">
                <answers></answers>
              </div>
            </div>
          </div>
        </div>

        <div class="mdl-cell mdl-cell--3-col mdl-cell--12-col-tablet mdl-cell--12-col-phone players">
          <player></player>
        </div>

      </div>

      <chat></chat>
    </div>
  </div>
  <dialog class="mdl-dialog" id="friendsDialog">
    <p class="mdl-dialog__title">Send Invites</p>
    <div class="mdl-dialog__content friends-panel">
      <div class="mdl-tabs mdl-js-tabs mdl-js-ripple-effect">
        <div class="mdl-tabs__tab-bar">
          <a href="#friends-panel" class="mdl-tabs__tab is-active">Friends</a>
          <a href="#users-panel" class="mdl-tabs__tab">Everyone</a>
        </div>
        <div class="mdl-tabs__panel is-active friends-results" id="friends-panel">
          <ul class="demo-list-item mdl-list">
            <li class="friends" ng-hide="value.email === friends.userEmail" ng-repeat="(key, value) in friends.userFriends" >
              <div class="user_content">
                <p class="mdl-list__item-primary-content">
                  <strong class="username">{{value.name}}</strong>
                  <i ng-hide="friends.checkFriendInUsers(value.email)" title="Add Friend" class="material-icons friends" ng-click="addFriend(value)">person_add</i>
                  <i ng-show="friends.checkFriendInUsers(value.email)" title="Send Invite" class="material-icons friends" ng-click="sendInvite(value)">record_voice_over</i>
                </p>
              </div>
            </li>
          </ul>
        </div>
        <div id="users-panel" class="mdl-tabs__panel">
          <div class="search-results">
            <ul class="demo-list-item mdl-list" >
              <li class="friends" ng-hide="value.email === friends.userEmail" ng-repeat="(key, value) in friends.registeredUsers" >
                <div class="user_content">
                  <p class="mdl-list__item-primary-content">
                    <strong class="username">{{value.name}}</strong>
                    <i ng-hide="friends.checkFriendInUsers(value.email)" title="Add Friend" class="material-icons friends" ng-click="addFriend(value)">person_add</i>
                    <i ng-show="friends.checkFriendInUsers(value.email)" title="Send Invite" class="material-icons friends" ng-click="sendInvite(value)">record_voice_over</i>
                  </p>
                </div>
              </li>
            </ul>
          </div>
          <div> 
          <input class="mdl-textfield__input search" type="text" placeholder="Search Players" ng-model="searchQuery" ng-change="findRegisteredUser(searchQuery)">
          <i class="material-icons search">search</i>
          </div>
        </div>
      </div>
    </div>
    <div class="mdl-dialog__actions">
      <button type="button" class="mdl-button close">Close</button>
    </div>
  </dialog>

<dialog class="mdl-dialog" id="notificationsDialog">
  <p class="mdl-dialog__title">Game Invites</p>
  <div class="mdl-dialog__content">
    <div class="notification_body">
    <div ng-show="friends.gameInvites.length <= 0"> 
      <h6>There are no Game Invites</h6>
    </div>
      <ul class="demo-list-item mdl-list">
        <li class="notification" ng-repeat="invite in friends.gameInvites">
          <div class="notification_content">
            <span class="mdl-list__item-primary-content">
              <strong class="username">
                {{ invite.message.senderName}}
              </strong>
                <i title="Delete Notification" class="material-icons notification" ng-click="deleteGameInvite($index)">delete</i>
                <i title="Join Game" class="material-icons notification" ng-click="joinGame($index, invite.message.location)">check_circle</i>
            </span>
            <p class="gamelink">
              <small class="text-muted time-content">
                {{invite.message.location}}
              </small>
            </p>
          </div>
        </li>
      </ul>
    </div>
  </div>
  <div class="mdl-dialog__actions">
    <button type="button" class="mdl-button close">Close</button>
  </div>
  </dialog>
  <!--Dialog Displaying Search and Invite Users-->
  <dialog class="mdl-dialog" id="searchModal">
      <h4 class="mdl-dialog__title">Search and Invite Players</h4>
      <div class="mdl-dialog__content">
        <div>
        <form>
            <div class="mdl-textfield mdl-js-textfield">
              <input type="text" class="mdl-textfield__input" id="search-query"
                placeholder="Search users..." ng-model="searchString"
                ng-change="searchDB(searchString)" autocomplete=off>
            </div>
          </form>
          </div>
          <div id="search-result">

            <table class="mdl-data-table mdl-js-data-table">
              <tbody>
                <tr ng-repeat="i in items">
                  <td>{{i.name}} </td>
                  <td ng-if="checkPlayer(i.email)" title="{{i.email}}">
                    <button ng-click="sendMailInvite(i.email, i.name)" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect">
                      Send Invite
                    </button>
                  </td>
                  <td ng-if="!checkPlayer(i.email)">
                    <button ng-disabled="true" class="mdl-button mdl-js-button mdl-button--raised">
                      User invited
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
      </div>
      <div class="mdl-dialog__actions">
        <button type="button" class="mdl-button close">Close</button>
      </div>
    </dialog>
    <!--Dialog for Minimum Players-->
    <dialog class ="mdl-dialog" id="minAlertModal">
      <h4 class="mdl-dialog__title" style="text-align:center">Alert message</h4>
      <div class="mdl-dialog__content">
        <p style="text-align:center">A minimum of three players are required to start the game</p>
      </div>

      <div class="mdl-dialog__actions">
        <button type="button" class="mdl-button close">Close</button>
      </div>

    </dialog>
    <!--Dialog for Maximum Players-->
    <dialog class ="mdl-dialog" id="maxAlertModal">
      <h4 class="mdl-dialog__title" style="text-align:center">Alert message</h4>
      <div class="mdl-dialog__content">
        <p style="text-align:center">You have exceeded the maximum allowed no of invites</p>
      </div>

      <div class="mdl-dialog__actions">
        <button type="button" class="mdl-button close">Close</button>
      </div>

    </dialog>
<!--Dialog Showing Game History-->
<dialog class="mdl-dialog" id="gameHistoryModal">
  <h6 class="mdl-dialog__title" style="text-align:center">Game History</h6>
  <div class="mdl-dialog__content">
    <div class="table-responsive">
      <table class="mdl-data-table mdl-js-data-table mdl-shadow--2dp">
        <thead>
          <tr>
            <th class="mdl-data-table__cell--non-numeric">
              GAME DATE
            </th>
            <th class="mdl-data-table__cell--non-numeric">
              FRIENDS PLAYED
            </th>
            <th class="mdl-data-table__cell--non-numeric">
              NO. OF ROUNDS
            </th>
            <th class="mdl-data-table__cell--non-numeric">
              WINNER
            </th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="toDisplay in allGames">
            <td class="mdl-data-table__cell--non-numeric">
              {{regexx.exec(toDisplay.started)[0]}}
            </td>
            <td class="mdl-data-table__cell--non-numeric">
              <a ng-click="displayfriends = !displayfriends">
                  {{toDisplay.players.length}} players...
                </a>
              <table ng-show='displayfriends'>
                <tr ng-repeat="name in toDisplay.players">
                  <td class="mdl-data-table__cell--non-numeric">
                    {{name.username}}
                  </td>
                </tr>
              </table>
            </td>
            <td class="mdl-data-table__cell--non-numeric">
              {{toDisplay.rounds}}
            </td>
            <td class="mdl-data-table__cell--non-numeric">
              {{toDisplay.winner}}
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <div class="mdl-dialog__actions">
    <button type="button" class="mdl-button close">Close</button>
  </div>
</dialog>
</div>
<dialog class="mdl-dialog" id="showMyDialog">
  <div class="mdl-dialog__content">
    <p>You are about to start a game that will be saved</p>
  </div>
  <div class="mdl-dialog__actions">
    <button type="button" class="mdl-button proceed">PROCEED</button>
    <button type="button" class="mdl-button close" ng-click="dialog.close();">CANCEL</button>
  </div>
</dialog>
